---
title: "Models"
bibliography: refs.bibtex
---

```{r setup, include = FALSE}

  knitr::opts_chunk$set(collapse = TRUE,
                        comment  = "#>")

  fpath <- system.file("extdata", "prefab_model_controls.yaml", package = "portalcasting")
  model_controls <- yaml::read_yaml(fpath)
  model_names    <- names(model_controls)
  model_names    <- model_names[!(model_names %in% c("jags_logistic", "jags_logistic_covariates", "jags_logistic_competition", "jags_logistic_competition_covariates"))]
  nmodels        <- length(model_names)
  nmodels_text   <- as.character(english::english(nmodels))


```

<br>

We currently analyze and forecast rodent data at Portal using `r nmodels_text` models: `r model_names` [@PortalPredictions]. Each model has a function with its name (*e.g.*, `ESSS()`) which is called from an associated R script in the `models` subdirectory with its name (*e.g.*, `ESSS.R`)


```{r echo = FALSE, results = "asis"}

  template <- "## %s \n \n %s \n \n   \n"

  for (i in 1:nmodels) {
    model_i_controls <- model_controls[[i]]
    cat(sprintf(template, model_i_controls$metadata$name, model_i_controls$metadata$text))
  }
```


## Ensemble

In addition to the base models, we include a starting-point ensemble. In versions before v0.9.0, the ensemble was based on AIC weights, but in the shift to separating the interpolated from non-interpolated data in model fitting, we had to transfer to an unweighted average ensemble model. The ensemble mean is calculated as the mean of all model means and the ensemble variance is estimated as the sum of the mean of all model variances and the variance of the estimated mean, calculated using the unbiased estimate of sample variances.


# References
